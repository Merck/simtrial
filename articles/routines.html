<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="simtrial">
<title>Basic tools for time-to-event trial simulation and testing â€¢ simtrial</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Basic tools for time-to-event trial simulation and testing">
<meta property="og:description" content="simtrial">
<meta property="og:image" content="https://merck.github.io/simtrial/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">simtrial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Merck/simtrial/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Basic tools for time-to-event trial simulation and testing</h1>
                        <h4 data-toc-skip class="author">Keaven
Anderson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Merck/simtrial/blob/HEAD/vignettes/routines.Rmd" class="external-link"><code>vignettes/routines.Rmd</code></a></small>
      <div class="d-none name"><code>routines.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates the lower-level routines in the simtrial
package specifically related to trial generation and statistical
testing.</p>
<p>The routines are as follows:</p>
<ul>
<li>
<code><a href="../reference/randomize_by_fixed_block.html">randomize_by_fixed_block()</a></code> - fixed block
randomization</li>
<li>
<code><a href="../reference/rpwexp_enroll.html">rpwexp_enroll()</a></code> - random inter-arrival times with
piecewise constant enrollment rates</li>
<li>
<code><a href="../reference/rpwexp.html">rpwexp()</a></code> - piecewise exponential failure rate
generation</li>
<li>
<code><a href="../reference/cut_data_by_date.html">cut_data_by_date()</a></code> - cut data for analysis at a
specified calendar time</li>
<li>
<code><a href="../reference/cut_data_by_event.html">cut_data_by_event()</a></code> - cut data for analysis at a
specified event count, including ties on the cutoff date</li>
<li>
<code><a href="../reference/get_cut_date_by_event.html">get_cut_date_by_event()</a></code> - find date at which an event
count is reached</li>
<li>
<code><a href="../reference/counting_process.html">counting_process()</a></code> - pre-process survival data into a
counting process format</li>
</ul>
<p>Application of the above is demonstrated using higher-level routines
<code><a href="../reference/sim_pw_surv.html">sim_pw_surv()</a></code> and <code><a href="../reference/sim_fixed_n.html">sim_fixed_n()</a></code> to generate
simulations and weighted logrank analysis for a stratified design.</p>
<p>The intent has been to write these routines in the spirit of the
tidyverse approach (alternately referred to as data wrangling, tidy
data, R for Data Science, or split-apply-combine). The other objectives
are to have an easily documentable and validated package that is easy to
use and efficient as a broadly-useful tool for simulation of
time-to-event clinical trials.</p>
<p>The package could be extended in many ways in the future,
including:</p>
<ul>
<li>Other analyses not supported in the survival package or other
acceptably validated package
<ul>
<li>Weighted logrank and weighted Kaplan-Meier analyses</li>
<li>One-step, hazard ratio estimator (first-order approximation of
PH)</li>
</ul>
</li>
<li>Randomization schemes other than stratified, fixed-block</li>
<li>Poisson mixture or other survival distribution generation</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://merck.github.io/simtrial/">simtrial</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="randomization">Randomization<a class="anchor" aria-label="anchor" href="#randomization"></a>
</h2>
<p>Fixed block randomization with an arbitrary block contents is
performed as demonstrated below. In this case we have a block size of 5
with one string repeated twice in each block and three other strings
appearing once each.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/randomize_by_fixed_block.html">randomize_by_fixed_block</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, block <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"Dog"</span>, <span class="st">"Cat"</span>, <span class="st">"Cat"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "A"   "Dog" "Cat" "Cat" "Dog" "Cat" "A"   "Cat" "Cat" "Dog"</span></span></code></pre></div>
<p>More normally, with a default of blocks of size four:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/randomize_by_fixed_block.html">randomize_by_fixed_block</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 0 0 1 1 1 0 0 1 0 1 0 1 1 0 0 1 1 1 0 0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="enrollment">Enrollment<a class="anchor" aria-label="anchor" href="#enrollment"></a>
</h2>
<p>Piecewise constant enrollment can be randomly generated as follows.
Note that duration is specifies interval durations for constant rates;
the final rate is extended as long as needed to generate the specified
number of observations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rpwexp_enroll.html">rpwexp_enroll</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  enroll_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 0.4321713 1.1920483 1.3606775 1.4337998 1.9976912 2.2833587 2.3205687</span></span>
<span><span class="co">#&gt;  [8] 2.3603258 2.4128677 2.5312003 2.5393496 2.8971532 3.0539522 3.2447750</span></span>
<span><span class="co">#&gt; [15] 3.6015153 3.6141447 3.7810793 4.2056592 4.4276540 4.5577338</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="time-to-event-and-time-to-dropout">Time-to-event and time-to-dropout<a class="anchor" aria-label="anchor" href="#time-to-event-and-time-to-dropout"></a>
</h2>
<p>Time-to-event and time-to-dropout random number generation for
observations is generated with piecewise exponential failure times. For
a large number of observations, a log-plot of the time-to-failure</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpwexp.html">rpwexp</a></span><span class="op">(</span></span>
<span>  <span class="fl">10000</span>,</span>
<span>  fail_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="op">(</span><span class="fl">10000</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10001</span>,</span>
<span>  log <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"PW Exponential simulated survival curve"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"P{Survival}"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="routines_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="generating-a-trial">Generating a trial<a class="anchor" aria-label="anchor" href="#generating-a-trial"></a>
</h2>
<p>Ideally, this might be done with a routine where generation of
randomization, and time-to-event data could be done in a modular fashion
plugged into a general trial generation routine. For now, stratified
randomization, piecewise constant enrollment, fixed block randomization
and piecewise exponential failure rates support a flexible set of trial
generation options for time-to-event endpoint trials. At present, follow
this format very carefully as little checking of input has been
developed to-date. The methods used here have all be demonstrated above,
but here they are combined in a single routine to generate a trial. Note
that in the generated output dataset, <code>cte</code> is the calendar
time of an event or dropout, whichever comes first, and
<code>fail</code> is an indicator that <code>cte</code> represents an
event time.</p>
<p>First we set up input variables to make the later call to
<code><a href="../reference/sim_pw_surv.html">sim_pw_surv()</a></code> more straightforward to read.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Positive"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"experimental"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">enroll_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">9</span><span class="op">)</span>, duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fail_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"experimental"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">4.5</span>, <span class="fl">10</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">18</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dropout_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  stratum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"experimental"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.001</span>, <span class="fl">.001</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_pw_surv.html">sim_pw_surv</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">400</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">stratum</span>,</span>
<span>  block <span class="op">=</span> <span class="va">block</span>,</span>
<span>  enroll_rate <span class="op">=</span> <span class="va">enroll_rate</span>,</span>
<span>  fail_rate <span class="op">=</span> <span class="va">fail_rate</span>,</span>
<span>  dropout_rate <span class="op">=</span> <span class="va">dropout_rate</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"enroll_time"</span>, <span class="st">"fail_time"</span>, <span class="st">"dropout_time"</span>, <span class="st">"cte"</span><span class="op">)</span>, decimals <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div id="afosjmturx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#afosjmturx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#afosjmturx thead, #afosjmturx tbody, #afosjmturx tfoot, #afosjmturx tr, #afosjmturx td, #afosjmturx th {
  border-style: none;
}

#afosjmturx p {
  margin: 0;
  padding: 0;
}

#afosjmturx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#afosjmturx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#afosjmturx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#afosjmturx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#afosjmturx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#afosjmturx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#afosjmturx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#afosjmturx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#afosjmturx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#afosjmturx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#afosjmturx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#afosjmturx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#afosjmturx .gt_spanner_row {
  border-bottom-style: hidden;
}

#afosjmturx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#afosjmturx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#afosjmturx .gt_from_md > :first-child {
  margin-top: 0;
}

#afosjmturx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#afosjmturx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#afosjmturx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#afosjmturx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#afosjmturx .gt_row_group_first td {
  border-top-width: 2px;
}

#afosjmturx .gt_row_group_first th {
  border-top-width: 2px;
}

#afosjmturx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#afosjmturx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#afosjmturx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#afosjmturx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#afosjmturx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#afosjmturx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#afosjmturx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#afosjmturx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#afosjmturx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#afosjmturx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#afosjmturx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#afosjmturx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#afosjmturx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#afosjmturx .gt_left {
  text-align: left;
}

#afosjmturx .gt_center {
  text-align: center;
}

#afosjmturx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#afosjmturx .gt_font_normal {
  font-weight: normal;
}

#afosjmturx .gt_font_bold {
  font-weight: bold;
}

#afosjmturx .gt_font_italic {
  font-style: italic;
}

#afosjmturx .gt_super {
  font-size: 65%;
}

#afosjmturx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#afosjmturx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#afosjmturx .gt_indent_1 {
  text-indent: 5px;
}

#afosjmturx .gt_indent_2 {
  text-indent: 10px;
}

#afosjmturx .gt_indent_3 {
  text-indent: 15px;
}

#afosjmturx .gt_indent_4 {
  text-indent: 20px;
}

#afosjmturx .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="stratum">stratum</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="enroll_time">enroll_time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="treatment">treatment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="fail_time">fail_time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="dropout_time">dropout_time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cte">cte</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="fail">fail</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="enroll_time" class="gt_row gt_right">0.02</td>
<td headers="treatment" class="gt_row gt_left">control</td>
<td headers="fail_time" class="gt_row gt_right">0.56</td>
<td headers="dropout_time" class="gt_row gt_right">27.24</td>
<td headers="cte" class="gt_row gt_right">0.58</td>
<td headers="fail" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="enroll_time" class="gt_row gt_right">0.69</td>
<td headers="treatment" class="gt_row gt_left">experimental</td>
<td headers="fail_time" class="gt_row gt_right">3.32</td>
<td headers="dropout_time" class="gt_row gt_right">1,893.19</td>
<td headers="cte" class="gt_row gt_right">4.01</td>
<td headers="fail" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="enroll_time" class="gt_row gt_right">0.80</td>
<td headers="treatment" class="gt_row gt_left">control</td>
<td headers="fail_time" class="gt_row gt_right">1.16</td>
<td headers="dropout_time" class="gt_row gt_right">820.85</td>
<td headers="cte" class="gt_row gt_right">1.96</td>
<td headers="fail" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Positive</td>
<td headers="enroll_time" class="gt_row gt_right">1.07</td>
<td headers="treatment" class="gt_row gt_left">control</td>
<td headers="fail_time" class="gt_row gt_right">5.68</td>
<td headers="dropout_time" class="gt_row gt_right">112.63</td>
<td headers="cte" class="gt_row gt_right">6.75</td>
<td headers="fail" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="enroll_time" class="gt_row gt_right">1.13</td>
<td headers="treatment" class="gt_row gt_left">experimental</td>
<td headers="fail_time" class="gt_row gt_right">64.98</td>
<td headers="dropout_time" class="gt_row gt_right">2,670.46</td>
<td headers="cte" class="gt_row gt_right">66.11</td>
<td headers="fail" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="enroll_time" class="gt_row gt_right">1.14</td>
<td headers="treatment" class="gt_row gt_left">experimental</td>
<td headers="fail_time" class="gt_row gt_right">8.19</td>
<td headers="dropout_time" class="gt_row gt_right">531.96</td>
<td headers="cte" class="gt_row gt_right">9.34</td>
<td headers="fail" class="gt_row gt_right">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="cutting-data-for-analysis">Cutting data for analysis<a class="anchor" aria-label="anchor" href="#cutting-data-for-analysis"></a>
</h2>
<p>There two ways to cut off data in the generated dataset
<code>x</code> from above. The first uses a calendar cutoff date. The
output only includes the time from randomization to event or dropout
(<code>tte</code>), and indicator that this represents and event
(<code>event</code>), the stratum in which the observation was generated
(<code>stratum</code>) and the treatment group assigned
(<code>treatment</code>). Observations enrolled after the input
<code>cut_date</code> are deleted and events and censoring from
<code>x</code> that are after the <code>cut_date</code> are censored at
the specified <code>cut_date</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cut_data_by_date.html">cut_data_by_date</a></span><span class="op">(</span><span class="va">x</span>, cut_date <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="st">"tte"</span>, decimals <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div id="zgplxvyosi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zgplxvyosi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zgplxvyosi thead, #zgplxvyosi tbody, #zgplxvyosi tfoot, #zgplxvyosi tr, #zgplxvyosi td, #zgplxvyosi th {
  border-style: none;
}

#zgplxvyosi p {
  margin: 0;
  padding: 0;
}

#zgplxvyosi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zgplxvyosi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zgplxvyosi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zgplxvyosi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zgplxvyosi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zgplxvyosi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zgplxvyosi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zgplxvyosi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zgplxvyosi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zgplxvyosi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zgplxvyosi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zgplxvyosi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zgplxvyosi .gt_spanner_row {
  border-bottom-style: hidden;
}

#zgplxvyosi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zgplxvyosi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zgplxvyosi .gt_from_md > :first-child {
  margin-top: 0;
}

#zgplxvyosi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zgplxvyosi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zgplxvyosi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zgplxvyosi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zgplxvyosi .gt_row_group_first td {
  border-top-width: 2px;
}

#zgplxvyosi .gt_row_group_first th {
  border-top-width: 2px;
}

#zgplxvyosi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zgplxvyosi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zgplxvyosi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zgplxvyosi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zgplxvyosi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zgplxvyosi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zgplxvyosi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zgplxvyosi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zgplxvyosi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zgplxvyosi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zgplxvyosi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zgplxvyosi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zgplxvyosi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zgplxvyosi .gt_left {
  text-align: left;
}

#zgplxvyosi .gt_center {
  text-align: center;
}

#zgplxvyosi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zgplxvyosi .gt_font_normal {
  font-weight: normal;
}

#zgplxvyosi .gt_font_bold {
  font-weight: bold;
}

#zgplxvyosi .gt_font_italic {
  font-style: italic;
}

#zgplxvyosi .gt_super {
  font-size: 65%;
}

#zgplxvyosi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zgplxvyosi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zgplxvyosi .gt_indent_1 {
  text-indent: 5px;
}

#zgplxvyosi .gt_indent_2 {
  text-indent: 10px;
}

#zgplxvyosi .gt_indent_3 {
  text-indent: 15px;
}

#zgplxvyosi .gt_indent_4 {
  text-indent: 20px;
}

#zgplxvyosi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="tte">tte</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="event">event</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="stratum">stratum</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="treatment">treatment</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="tte" class="gt_row gt_right">0.56</td>
<td headers="event" class="gt_row gt_right">1</td>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="treatment" class="gt_row gt_left">control</td>
</tr>
<tr>
<td headers="tte" class="gt_row gt_right">3.32</td>
<td headers="event" class="gt_row gt_right">1</td>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="treatment" class="gt_row gt_left">experimental</td>
</tr>
<tr>
<td headers="tte" class="gt_row gt_right">1.16</td>
<td headers="event" class="gt_row gt_right">1</td>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="treatment" class="gt_row gt_left">control</td>
</tr>
<tr>
<td headers="tte" class="gt_row gt_right">3.93</td>
<td headers="event" class="gt_row gt_right">0</td>
<td headers="stratum" class="gt_row gt_left">Positive</td>
<td headers="treatment" class="gt_row gt_left">control</td>
</tr>
<tr>
<td headers="tte" class="gt_row gt_right">3.87</td>
<td headers="event" class="gt_row gt_right">0</td>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="treatment" class="gt_row gt_left">experimental</td>
</tr>
<tr>
<td headers="tte" class="gt_row gt_right">3.86</td>
<td headers="event" class="gt_row gt_right">0</td>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="treatment" class="gt_row gt_left">experimental</td>
</tr>
</tbody>
</table>
</div>
<p>For instance, if we wish to cut the entire dataset when 50 events are
observed in the Positive stratum we can use the
<code>get_cut_date_by_event</code> function as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cut50Positive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cut_date_by_event.html">get_cut_date_by_event</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">stratum</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">y50Positive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cut_data_by_date.html">cut_data_by_date</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cut50Positive</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">y50Positive</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">stratum</span>, <span class="va">event</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           event</span></span>
<span><span class="co">#&gt; stratum     0  1</span></span>
<span><span class="co">#&gt;   Negative 41 53</span></span>
<span><span class="co">#&gt;   Positive 46 50</span></span></code></pre></div>
<p>Perhaps the most common way to cut data is with an event count for
the overall population, which is done using the
<code>cut_data_by_event</code> function. Note that if there are tied
events at the date the <code>cte</code> the count is reached, all are
included. Also, if the count is never reached, all event times are
included in the cut - with no indication of an error.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y150</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cut_data_by_event.html">cut_data_by_event</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">150</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">y150</span><span class="op">$</span><span class="va">event</span>, <span class="va">y150</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;     control experimental</span></span>
<span><span class="co">#&gt;   0      44           54</span></span>
<span><span class="co">#&gt;   1      80           70</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generating-a-counting-process-dataset">Generating a counting process dataset<a class="anchor" aria-label="anchor" href="#generating-a-counting-process-dataset"></a>
</h2>
<p>Once we have cut data for analysis, we can create a dataset that is
very simple to use for weighted logrank tests. A slightly more complex
version could be developed in the future to enable Kaplan-Meier-based
tests. We take the dataset <code>y150</code> from above and process it
into this format. The counting process format is further discussed in
the next section where we compute a weighted logrank test.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ten150</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/counting_process.html">counting_process</a></span><span class="op">(</span><span class="va">y150</span>, arm <span class="op">=</span> <span class="st">"experimental"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ten150</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tte"</span>, <span class="st">"o_minus_e"</span>, <span class="st">"var_o_minus_e"</span><span class="op">)</span>, decimals <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div id="stejnxemki" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#stejnxemki table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#stejnxemki thead, #stejnxemki tbody, #stejnxemki tfoot, #stejnxemki tr, #stejnxemki td, #stejnxemki th {
  border-style: none;
}

#stejnxemki p {
  margin: 0;
  padding: 0;
}

#stejnxemki .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#stejnxemki .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#stejnxemki .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#stejnxemki .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#stejnxemki .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stejnxemki .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stejnxemki .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stejnxemki .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#stejnxemki .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#stejnxemki .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#stejnxemki .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#stejnxemki .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#stejnxemki .gt_spanner_row {
  border-bottom-style: hidden;
}

#stejnxemki .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#stejnxemki .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#stejnxemki .gt_from_md > :first-child {
  margin-top: 0;
}

#stejnxemki .gt_from_md > :last-child {
  margin-bottom: 0;
}

#stejnxemki .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#stejnxemki .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#stejnxemki .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#stejnxemki .gt_row_group_first td {
  border-top-width: 2px;
}

#stejnxemki .gt_row_group_first th {
  border-top-width: 2px;
}

#stejnxemki .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stejnxemki .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#stejnxemki .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#stejnxemki .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stejnxemki .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stejnxemki .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#stejnxemki .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#stejnxemki .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#stejnxemki .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stejnxemki .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stejnxemki .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stejnxemki .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stejnxemki .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stejnxemki .gt_left {
  text-align: left;
}

#stejnxemki .gt_center {
  text-align: center;
}

#stejnxemki .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#stejnxemki .gt_font_normal {
  font-weight: normal;
}

#stejnxemki .gt_font_bold {
  font-weight: bold;
}

#stejnxemki .gt_font_italic {
  font-style: italic;
}

#stejnxemki .gt_super {
  font-size: 65%;
}

#stejnxemki .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#stejnxemki .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#stejnxemki .gt_indent_1 {
  text-indent: 5px;
}

#stejnxemki .gt_indent_2 {
  text-indent: 10px;
}

#stejnxemki .gt_indent_3 {
  text-indent: 15px;
}

#stejnxemki .gt_indent_4 {
  text-indent: 20px;
}

#stejnxemki .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="stratum">stratum</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="events">events</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n_event_tol">n_event_tol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="tte">tte</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n_risk_tol">n_risk_tol</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n_risk_trt">n_risk_trt</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="s">s</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="o_minus_e">o_minus_e</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="var_o_minus_e">var_o_minus_e</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="events" class="gt_row gt_right">1</td>
<td headers="n_event_tol" class="gt_row gt_right">0</td>
<td headers="tte" class="gt_row gt_right">0.06</td>
<td headers="n_risk_tol" class="gt_row gt_right">124</td>
<td headers="n_risk_trt" class="gt_row gt_right">62</td>
<td headers="s" class="gt_row gt_right">1.0000000</td>
<td headers="o_minus_e" class="gt_row gt_right">âˆ’0.50</td>
<td headers="var_o_minus_e" class="gt_row gt_right">0.25</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="events" class="gt_row gt_right">1</td>
<td headers="n_event_tol" class="gt_row gt_right">1</td>
<td headers="tte" class="gt_row gt_right">0.06</td>
<td headers="n_risk_tol" class="gt_row gt_right">123</td>
<td headers="n_risk_trt" class="gt_row gt_right">62</td>
<td headers="s" class="gt_row gt_right">0.9919355</td>
<td headers="o_minus_e" class="gt_row gt_right">0.50</td>
<td headers="var_o_minus_e" class="gt_row gt_right">0.25</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="events" class="gt_row gt_right">1</td>
<td headers="n_event_tol" class="gt_row gt_right">1</td>
<td headers="tte" class="gt_row gt_right">0.15</td>
<td headers="n_risk_tol" class="gt_row gt_right">122</td>
<td headers="n_risk_trt" class="gt_row gt_right">61</td>
<td headers="s" class="gt_row gt_right">0.9838710</td>
<td headers="o_minus_e" class="gt_row gt_right">0.50</td>
<td headers="var_o_minus_e" class="gt_row gt_right">0.25</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="events" class="gt_row gt_right">1</td>
<td headers="n_event_tol" class="gt_row gt_right">0</td>
<td headers="tte" class="gt_row gt_right">0.15</td>
<td headers="n_risk_tol" class="gt_row gt_right">121</td>
<td headers="n_risk_trt" class="gt_row gt_right">60</td>
<td headers="s" class="gt_row gt_right">0.9758065</td>
<td headers="o_minus_e" class="gt_row gt_right">âˆ’0.50</td>
<td headers="var_o_minus_e" class="gt_row gt_right">0.25</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="events" class="gt_row gt_right">1</td>
<td headers="n_event_tol" class="gt_row gt_right">1</td>
<td headers="tte" class="gt_row gt_right">0.23</td>
<td headers="n_risk_tol" class="gt_row gt_right">120</td>
<td headers="n_risk_trt" class="gt_row gt_right">60</td>
<td headers="s" class="gt_row gt_right">0.9677419</td>
<td headers="o_minus_e" class="gt_row gt_right">0.50</td>
<td headers="var_o_minus_e" class="gt_row gt_right">0.25</td>
</tr>
<tr>
<td headers="stratum" class="gt_row gt_left">Negative</td>
<td headers="events" class="gt_row gt_right">1</td>
<td headers="n_event_tol" class="gt_row gt_right">0</td>
<td headers="tte" class="gt_row gt_right">0.27</td>
<td headers="n_risk_tol" class="gt_row gt_right">119</td>
<td headers="n_risk_trt" class="gt_row gt_right">59</td>
<td headers="s" class="gt_row gt_right">0.9596774</td>
<td headers="o_minus_e" class="gt_row gt_right">âˆ’0.50</td>
<td headers="var_o_minus_e" class="gt_row gt_right">0.25</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="logrank-and-weighted-logrank-testing">Logrank and weighted logrank testing<a class="anchor" aria-label="anchor" href="#logrank-and-weighted-logrank-testing"></a>
</h2>
<p>Now stratified logrank and stratified weighted logrank tests are
easily generated based on the counting process format. Each record in
the counting process dataset represents a <code>tte</code> at which one
or more events occurs; the results are stratum-specific. Included in the
observation is the number of such events overall (<code>events</code>)
and in the experimental treatment group (<code>txevents</code>), the
number at risk overall (<code>atrisk</code>) and in the experimental
treatment group (<code>txatrisk</code>) just before <code>tte</code>,
the combined treatment group Kaplan-Meier survival estimate
(left-continuous) at <code>tte</code>, the observed events in
experimental group minus the expected at <code>tte</code> based on an
assumption that all at risk observations are equally likely to have an
event at any time, and the variance for this quantity
(<code>Var</code>).</p>
<p>To generate a stratified logrank test and a corresponding one-sided
p-value, we simply do the following:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">ten150</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">o_minus_e</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">var_o_minus_e</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -2.505355629  0.006116416</span></span></code></pre></div>
<p>A Fleming-Harrington <span class="math inline">\(\rho=1\)</span>,
<span class="math inline">\(\gamma=2\)</span> is nearly as simple. We
again compute a z-statistic and its corresponding one-sided p-value.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">ten150</span>, w <span class="op">=</span> <span class="va">s</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">s</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xx</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">o_minus_e</span> <span class="op">*</span> <span class="va">w</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_o_minus_e</span> <span class="op">*</span> <span class="va">w</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.1970797  0.4218826</span></span></code></pre></div>
<p>For Fleming-Harrington tests, a routine has been built to do these
tests for you:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fh00</span> <span class="op">&lt;-</span> <span class="va">y150</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/wlr.html">wlr</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="fu"><a href="../reference/fh.html">fh</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="fl">0</span>, gamma <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fh01</span> <span class="op">&lt;-</span> <span class="va">y150</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/wlr.html">wlr</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="fu"><a href="../reference/fh.html">fh</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="fl">0</span>, gamma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fh10</span> <span class="op">&lt;-</span> <span class="va">y150</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/wlr.html">wlr</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="fu"><a href="../reference/fh.html">fh</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fh11</span> <span class="op">&lt;-</span> <span class="va">y150</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/wlr.html">wlr</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="fu"><a href="../reference/fh.html">fh</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp_tbl</span> <span class="op">&lt;-</span> <span class="va">fh00</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fh01</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fh10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fh11</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">temp_tbl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Test 1"</span>, <span class="st">"Test 2"</span>, <span class="st">"Test 3"</span>, <span class="st">"Test 4"</span><span class="op">)</span></span>
<span><span class="va">temp_tbl</span></span>
<span><span class="co">#&gt;                        Test 1             Test 2             Test 3</span></span>
<span><span class="co">#&gt; method                    WLR                WLR                WLR</span></span>
<span><span class="co">#&gt; parameter  FH(rho=0, gamma=0) FH(rho=0, gamma=1) FH(rho=1, gamma=0)</span></span>
<span><span class="co">#&gt; estimation  -14.9849475025986  -4.58833802802725  -10.3966094745713</span></span>
<span><span class="co">#&gt; se           5.98116583796613   2.21990881849575   4.28272384915455</span></span>
<span><span class="co">#&gt; z           -2.50535562941256  -2.06690382496719  -2.42756942561769</span></span>
<span><span class="co">#&gt;                        Test 4</span></span>
<span><span class="co">#&gt; method                    WLR</span></span>
<span><span class="co">#&gt; parameter  FH(rho=1, gamma=1)</span></span>
<span><span class="co">#&gt; estimation  -2.69994556253347</span></span>
<span><span class="co">#&gt; se           1.13659961009608</span></span>
<span><span class="co">#&gt; z           -2.37545881465262</span></span></code></pre></div>
<p>If we wanted to take the minimum of these for a MaxCombo test, we
would first use <code>fh_weight()</code> to compute a correlation matrix
for the above z-statistics as follows. Note that the ordering of
<code>rho_gamma</code> and <code>g</code> in the argument list is
opposite of the above. The correlation matrix for the
<code>z</code>-values is now in <code>V1</code>-<code>V4</code>. We can
compute a p-value for the MaxCombo as follows using
<code><a href="https://rdrr.io/pkg/mvtnorm/man/pmvnorm.html" class="external-link">mvtnorm::pmvnorm()</a></code>. Note the arguments for
<code>GenzBretz()</code> which are more stringent than the defaults; we
have also used these more stringent parameters in the example in the
help file.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y150</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/maxcombo.html">maxcombo</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "MaxCombo"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $parameter</span></span>
<span><span class="co">#&gt; [1] "FH(0, 0) + FH(0, 1) + FH(1, 0) + FH(1, 1)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $z</span></span>
<span><span class="co">#&gt; [1] -2.505356 -2.066904 -2.427569 -2.375459</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_value</span></span>
<span><span class="co">#&gt; [1] 0.0125865</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simplification-for-2-arm-trials">Simplification for 2-arm trials<a class="anchor" aria-label="anchor" href="#simplification-for-2-arm-trials"></a>
</h2>
<p>The <code><a href="../reference/sim_fixed_n.html">sim_fixed_n()</a></code> routine combines much of the above to
go straight to generating tests for individual trials so that cutting
data and analyzing do not need to be done separately. Here the argument
structure is meant to be simpler than for
<code><a href="../reference/sim_pw_surv.html">sim_pw_surv()</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>stratum <span class="op">=</span> <span class="st">"All"</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">enroll_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fail_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  stratum <span class="op">=</span> <span class="st">"All"</span>,</span>
<span>  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  fail_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">18</span><span class="op">)</span>,</span>
<span>  hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>  dropout_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"experimental"</span>, <span class="st">"control"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">rho_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="fl">0</span>, gamma <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>Now we simulate a trial 2 times and cut data for analysis based on
<code>timing_type = 1:5</code> which translates to:</p>
<ol style="list-style-type: decimal">
<li>the planned study duration,</li>
<li>targeted event count is achieved,</li>
<li>planned minimum follow-up after enrollment is complete,</li>
<li>the maximum of 1 and 2,</li>
<li>the maximum of 2 and 3.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sim_fixed_n.html">sim_fixed_n</a></span><span class="op">(</span></span>
<span>  n_sim <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Number of simulations</span></span>
<span>  sample_size <span class="op">=</span> <span class="fl">500</span>, <span class="co"># Trial sample size</span></span>
<span>  target_event <span class="op">=</span> <span class="fl">350</span>, <span class="co"># Targeted events at analysis</span></span>
<span>  stratum <span class="op">=</span> <span class="va">stratum</span>, <span class="co"># Study stratum</span></span>
<span>  enroll_rate <span class="op">=</span> <span class="va">enroll_rate</span>, <span class="co"># Enrollment rates</span></span>
<span>  fail_rate <span class="op">=</span> <span class="va">fail_rate</span>, <span class="co"># Failure rates</span></span>
<span>  total_duration <span class="op">=</span> <span class="fl">30</span>, <span class="co"># Planned trial duration</span></span>
<span>  block <span class="op">=</span> <span class="va">block</span>, <span class="co"># Block for treatment</span></span>
<span>  timing_type <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="co"># Use all possible data cutoff methods</span></span>
<span>  rho_gamma <span class="op">=</span> <span class="va">rho_gamma</span> <span class="co"># FH test(s) to use; in this case, logrank</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ln_hr"</span>, <span class="st">"z"</span>, <span class="st">"duration"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Backend uses sequential processing.</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: future</span></span></code></pre></div>
<div id="wncpqjmejn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wncpqjmejn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wncpqjmejn thead, #wncpqjmejn tbody, #wncpqjmejn tfoot, #wncpqjmejn tr, #wncpqjmejn td, #wncpqjmejn th {
  border-style: none;
}

#wncpqjmejn p {
  margin: 0;
  padding: 0;
}

#wncpqjmejn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wncpqjmejn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wncpqjmejn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wncpqjmejn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wncpqjmejn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wncpqjmejn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wncpqjmejn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wncpqjmejn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wncpqjmejn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wncpqjmejn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wncpqjmejn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wncpqjmejn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wncpqjmejn .gt_spanner_row {
  border-bottom-style: hidden;
}

#wncpqjmejn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wncpqjmejn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wncpqjmejn .gt_from_md > :first-child {
  margin-top: 0;
}

#wncpqjmejn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wncpqjmejn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wncpqjmejn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wncpqjmejn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wncpqjmejn .gt_row_group_first td {
  border-top-width: 2px;
}

#wncpqjmejn .gt_row_group_first th {
  border-top-width: 2px;
}

#wncpqjmejn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wncpqjmejn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wncpqjmejn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wncpqjmejn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wncpqjmejn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wncpqjmejn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wncpqjmejn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wncpqjmejn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wncpqjmejn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wncpqjmejn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wncpqjmejn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wncpqjmejn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wncpqjmejn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wncpqjmejn .gt_left {
  text-align: left;
}

#wncpqjmejn .gt_center {
  text-align: center;
}

#wncpqjmejn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wncpqjmejn .gt_font_normal {
  font-weight: normal;
}

#wncpqjmejn .gt_font_bold {
  font-weight: bold;
}

#wncpqjmejn .gt_font_italic {
  font-style: italic;
}

#wncpqjmejn .gt_super {
  font-size: 65%;
}

#wncpqjmejn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wncpqjmejn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wncpqjmejn .gt_indent_1 {
  text-indent: 5px;
}

#wncpqjmejn .gt_indent_2 {
  text-indent: 10px;
}

#wncpqjmejn .gt_indent_3 {
  text-indent: 15px;
}

#wncpqjmejn .gt_indent_4 {
  text-indent: 20px;
}

#wncpqjmejn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="method">method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="parameter">parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimation">estimation</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="se">se</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="z">z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="event">event</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ln_hr">ln_hr</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="cut">cut</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="duration">duration</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sim">sim</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-2.993631</td>
<td headers="se" class="gt_row gt_right">5.496021</td>
<td headers="z" class="gt_row gt_right">âˆ’0.54</td>
<td headers="event" class="gt_row gt_right">121</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.10</td>
<td headers="cut" class="gt_row gt_left">Planned duration</td>
<td headers="duration" class="gt_row gt_right">30.00</td>
<td headers="sim" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-34.168255</td>
<td headers="se" class="gt_row gt_right">9.280556</td>
<td headers="z" class="gt_row gt_right">âˆ’3.68</td>
<td headers="event" class="gt_row gt_right">350</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.40</td>
<td headers="cut" class="gt_row gt_left">Targeted events</td>
<td headers="duration" class="gt_row gt_right">64.89</td>
<td headers="sim" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-38.109119</td>
<td headers="se" class="gt_row gt_right">9.562882</td>
<td headers="z" class="gt_row gt_right">âˆ’3.99</td>
<td headers="event" class="gt_row gt_right">375</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.41</td>
<td headers="cut" class="gt_row gt_left">Minimum follow-up</td>
<td headers="duration" class="gt_row gt_right">71.75</td>
<td headers="sim" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-34.168255</td>
<td headers="se" class="gt_row gt_right">9.280556</td>
<td headers="z" class="gt_row gt_right">âˆ’3.68</td>
<td headers="event" class="gt_row gt_right">350</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.40</td>
<td headers="cut" class="gt_row gt_left">Max(planned duration, event cut)</td>
<td headers="duration" class="gt_row gt_right">64.89</td>
<td headers="sim" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-38.109119</td>
<td headers="se" class="gt_row gt_right">9.562882</td>
<td headers="z" class="gt_row gt_right">âˆ’3.99</td>
<td headers="event" class="gt_row gt_right">375</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.41</td>
<td headers="cut" class="gt_row gt_left">Max(min follow-up, event cut)</td>
<td headers="duration" class="gt_row gt_right">71.75</td>
<td headers="sim" class="gt_row gt_right">1</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-17.318876</td>
<td headers="se" class="gt_row gt_right">4.922279</td>
<td headers="z" class="gt_row gt_right">âˆ’3.52</td>
<td headers="event" class="gt_row gt_right">99</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.73</td>
<td headers="cut" class="gt_row gt_left">Planned duration</td>
<td headers="duration" class="gt_row gt_right">30.00</td>
<td headers="sim" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-37.749178</td>
<td headers="se" class="gt_row gt_right">9.190180</td>
<td headers="z" class="gt_row gt_right">âˆ’4.11</td>
<td headers="event" class="gt_row gt_right">350</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.44</td>
<td headers="cut" class="gt_row gt_left">Targeted events</td>
<td headers="duration" class="gt_row gt_right">65.91</td>
<td headers="sim" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-38.404129</td>
<td headers="se" class="gt_row gt_right">9.452228</td>
<td headers="z" class="gt_row gt_right">âˆ’4.06</td>
<td headers="event" class="gt_row gt_right">371</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.42</td>
<td headers="cut" class="gt_row gt_left">Minimum follow-up</td>
<td headers="duration" class="gt_row gt_right">73.50</td>
<td headers="sim" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-37.749178</td>
<td headers="se" class="gt_row gt_right">9.190180</td>
<td headers="z" class="gt_row gt_right">âˆ’4.11</td>
<td headers="event" class="gt_row gt_right">350</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.44</td>
<td headers="cut" class="gt_row gt_left">Max(planned duration, event cut)</td>
<td headers="duration" class="gt_row gt_right">65.91</td>
<td headers="sim" class="gt_row gt_right">2</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_left">WLR</td>
<td headers="parameter" class="gt_row gt_left">FH(rho=0, gamma=0)</td>
<td headers="estimation" class="gt_row gt_right">-38.404129</td>
<td headers="se" class="gt_row gt_right">9.452228</td>
<td headers="z" class="gt_row gt_right">âˆ’4.06</td>
<td headers="event" class="gt_row gt_right">371</td>
<td headers="ln_hr" class="gt_row gt_right">âˆ’0.42</td>
<td headers="cut" class="gt_row gt_left">Max(min follow-up, event cut)</td>
<td headers="duration" class="gt_row gt_right">73.50</td>
<td headers="sim" class="gt_row gt_right">2</td>
</tr>
</tbody>
</table>
</div>
<p>If you look carefully, you should be asking why the cutoff with the
planned number of events is so different than the other data cutoff
methods. To explain, we note that generally you will want
<code>sample_size</code> above to match the enrollment specified in
<code>enroll_rate</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enroll_rate</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>  <span class="st">"Targeted enrollment based on input enrollment rates"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">duration</span> <span class="op">*</span> <span class="va">rate</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   Targeted enrollment based on input enrollment rates</span></span>
<span><span class="co">#&gt; 1                                                 108</span></span></code></pre></div>
<p>The targeted enrollment takes, on average, 30 months longer than the
sum of the enrollment durations in <code>enroll_rate</code> (14 months)
at the input enrollment rates. To achieve the input
<code>sample_size</code> of 500, the final enrollment rate is assumed to
be steady state and extends in each simulation until the targeted
enrollment is achieved. The planned duration of the trial is taken as 30
months as specified in <code>total_duration</code>. The targeted minimum
follow-up is</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">total_duration</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="co"># From above</span></span>
<span><span class="va">total_duration</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">enroll_rate</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 16</span></span></code></pre></div>
<p>It is thus, implicit that the last subject was enrolled 16 months
prior to the duration given for the cutoff with â€œMinimum follow-upâ€
cutoff in the simulations above. The planned duration cutoff is given in
the <code>total_duration</code> argument which results in a much earlier
cutoff.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson, Yujie Zhao, Yilong Zhang. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9. <br>Copyright Â© 2024 Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates. All rights reserved.</p>
</div>

<div class="pkgdown-footer-right">
  <p><span></span></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
