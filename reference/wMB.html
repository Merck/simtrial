<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Magirr and Burman Modestly Weighted Logrank Tests — wMB • simtrial</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Magirr and Burman Modestly Weighted Logrank Tests — wMB" />
<meta property="og:description" content="Magirr and Burman (2019) have proposed a weighted logrank test to have better power than
the logrank test when the treatment effect is delayed, but to still maintain good power under 
a proportional hazards assumption. 
The weights for some early interval specified by the user are the inverse of the combined treatment group
empirical survival distribution; see details. 
After this initial period, weights are constant at the maximum of the previous weights.
Another advantage of the test is that under strong null hypothesis that the underlying survival in the control group
is greater than or equal to underlying survival in the experimental group, 
Type I error is controlled as the specified level." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simtrial</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Regulatory/Industry Training Version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/arbitraryhazard.html">Approximating an arbitrary hazard function</a>
    </li>
    <li>
      <a href="../articles/modestWLRTVignette.html">Using the Magirr-Burman weights for testing</a>
    </li>
    <li>
      <a href="../articles/pMaxComboVignette.html">Computing p-values for Fleming-Harring weighted logrank tests and the MaxCombo test</a>
    </li>
    <li>
      <a href="../articles/simtrialroutines.html">Basic tools for time-to-event trial simulation and testing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Magirr and Burman Modestly Weighted Logrank Tests</h1>
    
    <div class="hidden name"><code>wMB.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Magirr and Burman (2019) have proposed a weighted logrank test to have better power than
the logrank test when the treatment effect is delayed, but to still maintain good power under 
a proportional hazards assumption. 
The weights for some early interval specified by the user are the inverse of the combined treatment group
empirical survival distribution; see details. 
After this initial period, weights are constant at the maximum of the previous weights.
Another advantage of the test is that under strong null hypothesis that the underlying survival in the control group
is greater than or equal to underlying survival in the experimental group, 
Type I error is controlled as the specified level.</p>
    </div>

    <pre class="usage"><span class='fu'>wMB</span><span class='op'>(</span><span class='va'>x</span>, delay <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code>tensurv</code>-class <code>tibble</code> with a counting process dataset</p></td>
    </tr>
    <tr>
      <th>delay</th>
      <td><p>The initial delay period where weights increase; 
after this, weights are constant at the final weigh in the delay period</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a vector with weights for the Magirr-Burman weighted logrank test
for the data in <code>x</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function computes Magirr-Burman weights and adds them to a dataset created by the <code><a href='tensurv.html'>tensurv()</a></code> function.
These weights can then be used to compute a Z-statistic for the modestly weighted logrank test proposed.</p>

<p>We define \(t^*\) to be the input variable <code>delay</code>.
This specifies an initial period during which weights increase.
To define specific weights, we let \(S(t)\) denote the Kaplan-Meier survival estimate at time \(t\)
for the combined data (control plus experimental treatment groups).
The weight at time \(t\) is then defined as
$$w(t)=S(\min(t,t^*))^{-1}.$$</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Magirr, Dominic, and Carl‐Fredrik Burman. 
"Modestly weighted logrank tests." 
<em>Statistics in Medicine</em> 38.20 (2019): 3782-3790.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='co'># Use default enrollment and event rates at cut at 100 events</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simPWSurv.html'>simPWSurv</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='cutDataAtCount.html'>cutDataAtCount</a></span><span class='op'>(</span><span class='fl'>125</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='tensurv.html'>tensurv</a></span><span class='op'>(</span>txval<span class='op'>=</span><span class='st'>"Experimental"</span><span class='op'>)</span>
<span class='co'># compute Magirr-Burman weights with </span>
<span class='va'>ZMB</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'>%&gt;%</span> <span class='fu'>wMB</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
             <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>S<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>OminusE</span><span class='op'>*</span><span class='va'>wMB</span><span class='op'>)</span>,V<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Var</span><span class='op'>*</span><span class='va'>wMB</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>,Z<span class='op'>=</span><span class='va'>S</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>V</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Compute p-value of modestly weighted logrank of Magirr-Burman</span>
<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span><span class='op'>(</span><span class='va'>ZMB</span><span class='op'>$</span><span class='va'>Z</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.005941756</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Keaven Anderson, Yilong Zhang. Site built with pkgdown 1.6.1.
  </p>
  <p>Copyright &copy; 2021 Merck Sharp & Dohme Corp., a subsidiary of Merck & Co., Inc., Kenilworth, NJ, USA.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


