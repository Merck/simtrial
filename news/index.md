# Changelog

## simtrial 1.0.1

CRAN release: 2025-09-11

### Statistical improvements

- A example of stratified group sequential design is added for the
  [`sim_gs_n()`](https://merck.github.io/simtrial/reference/sim_gs_n.md)
  function ([\#336](https://github.com/Merck/simtrial/issues/336),
  [\#343](https://github.com/Merck/simtrial/issues/343), thanks to
  [@LittleBeannie](https://github.com/LittleBeannie)).

### Computational improvements

- The `dplyr` syntax in
  [`sim_gs_n()`](https://merck.github.io/simtrial/reference/sim_gs_n.md)
  is replaced with `data.table` syntax for better speed
  ([\#339](https://github.com/Merck/simtrial/issues/339), thanks to
  [@jdblischak](https://github.com/jdblischak)).
- The `parallelelly` package version is temporarily downgraded to
  v1.44.0 for successful macOC build.
  ([\#341](https://github.com/Merck/simtrial/issues/341),
  [\#338](https://github.com/Merck/simtrial/issues/338), thanks to
  [@jdblischak](https://github.com/jdblischak)).

## simtrial 1.0.0

CRAN release: 2025-06-11

### Statistical improvements

- Provide the updated boundary for objects generated by
  [`sim_gs_n()`](https://merck.github.io/simtrial/reference/sim_gs_n.md)
  ([\#255](https://github.com/Merck/simtrial/issues/255), thanks to
  [@LittleBeannie](https://github.com/LittleBeannie)).
- Users can now pass a formula to call the
  [`wlr()`](https://merck.github.io/simtrial/reference/wlr.md) function
  ([\#280](https://github.com/Merck/simtrial/issues/280), thanks to
  [@jdblischak](https://github.com/jdblischak)).
- [`wlr()`](https://merck.github.io/simtrial/reference/wlr.md) is now a
  S3 class method for both `tte_data` class and `counting_process` class
  ([@276](https://github.com/276),
  [\#280](https://github.com/Merck/simtrial/issues/280),
  [@281](https://github.com/281), thanks to
  [@jdblischak](https://github.com/jdblischak))
- The randomization ratio is output as attributes of
  [`sim_pw_surv()`](https://merck.github.io/simtrial/reference/sim_pw_surv.md)
  ([\#279](https://github.com/Merck/simtrial/issues/279),
  [\#311](https://github.com/Merck/simtrial/issues/311) thanks to
  [@LittleBeannie](https://github.com/LittleBeannie) and
  [@jdblischak](https://github.com/jdblischak)).

### Documentation

- Add 3 vignettes introducing simulation of fixed or group sequential
  design via a single function call of
  [`sim_fixed_n()`](https://merck.github.io/simtrial/reference/sim_fixed_n.md)
  and
  [`sim_gs_n()`](https://merck.github.io/simtrial/reference/sim_gs_n.md)
  or from the ground up
  ([\#302](https://github.com/Merck/simtrial/issues/302),
  [\#316](https://github.com/Merck/simtrial/issues/316), thanks to
  [@LittleBeannie](https://github.com/LittleBeannie)).
- Add a vignette discussing the potential discrepancies between
  `simtrial` and `survdiff`
  ([\#308](https://github.com/Merck/simtrial/issues/308), thanks to
  [@larry-leon](https://github.com/larry-leon)).
- Update parallel vignette to address `data.table` multithreading
  ([\#319](https://github.com/Merck/simtrial/issues/319), thanks to
  [@jdblischak](https://github.com/jdblischak)).

### Speed improvements

- Optimize parallel simulation speed in
  [`sim_fixed_n()`](https://merck.github.io/simtrial/reference/sim_fixed_n.md)
  and
  [`sim_gs_n()`](https://merck.github.io/simtrial/reference/sim_gs_n.md)
  by replacing `foreach(.combine = "rbind")` with manual data frame
  combination ([\#318](https://github.com/Merck/simtrial/issues/318),
  thanks to [@nanxstats](https://github.com/nanxstats)).

## simtrial 0.4.2

CRAN release: 2024-11-18

### Statistical improvements

- Summary function of
  [`sim_gs_n()`](https://merck.github.io/simtrial/reference/sim_gs_n.md)
  is available ([\#268](https://github.com/Merck/simtrial/issues/268),
  thanks to [@LittleBeannie](https://github.com/LittleBeannie)).
- The denominator of the milestone test Z-score is corrected
  ([\#270](https://github.com/Merck/simtrial/issues/270), thanks to
  [@LittleBeannie](https://github.com/LittleBeannie)).
- Statistical information is added as output of
  [`sim_gs_n()`](https://merck.github.io/simtrial/reference/sim_gs_n.md)
  ([\#273](https://github.com/Merck/simtrial/issues/273), thanks to
  [@LittleBeannie](https://github.com/LittleBeannie)).
- The randomization ratio is built as an attribute of
  [`sim_pw_surv()`](https://merck.github.io/simtrial/reference/sim_pw_surv.md)
  and passed into the
  [`wlr()`](https://merck.github.io/simtrial/reference/wlr.md) test
  ([\#281](https://github.com/Merck/simtrial/issues/281),
  [\#285](https://github.com/Merck/simtrial/issues/285) thanks to
  [@LittleBeannie](https://github.com/LittleBeannie) and
  [@jdblischak](https://github.com/jdblischak)).
- The sign of the Z-score is unified to positive numbers
  ([\#272](https://github.com/Merck/simtrial/issues/272),
  [\#286](https://github.com/Merck/simtrial/issues/286), thanks to
  [@LittleBeannie](https://github.com/LittleBeannie) and
  [@jdblischak](https://github.com/jdblischak)).

### Computational improvements

- The source code of [`summary()`](https://rdrr.io/r/base/summary.html)
  is rewritten from `tibble` or `data.frame` to `data.table`, which is
  optimized to use as little memory as possible by avoiding making
  unnecessary temporary copies of data frames. This results in code that
  is more efficient in both time and memory use.
  ([\#289](https://github.com/Merck/simtrial/issues/289), thanks to
  [@jdblischak](https://github.com/jdblischak)).
- The
  [`sim_fixed_n()`](https://merck.github.io/simtrial/reference/sim_fixed_n.md)
  function has been updated to allow parallel simulations
  ([\#249](https://github.com/Merck/simtrial/issues/249),
  [\#252](https://github.com/Merck/simtrial/issues/252),
  [\#253](https://github.com/Merck/simtrial/issues/253),
  [\#262](https://github.com/Merck/simtrial/issues/262), thanks to
  [@cmansch](https://github.com/cmansch) and
  [@jdblischak](https://github.com/jdblischak)).

### Bug fixes

- Fixed the bug of cut functions in parallel
  ([\#261](https://github.com/Merck/simtrial/issues/261), thanks to
  [@cmansch](https://github.com/cmansch)).

### Coding improvements

- The [`wlr()`](https://merck.github.io/simtrial/reference/wlr.md)
  function is enhanced to S3 generic to accept both counting process and
  time-to-event data as its input
  ([\#276](https://github.com/Merck/simtrial/issues/276),
  [\#277](https://github.com/Merck/simtrial/issues/277), thanks to
  [@jdblischak](https://github.com/jdblischak)).

### Documentation

- Use KaTeX for pkgdown math rendering
  ([\#263](https://github.com/Merck/simtrial/issues/263), thanks to
  [@nanxstats](https://github.com/nanxstats)).

### Tests

- Regression tests of [`summary()`](https://rdrr.io/r/base/summary.html)
  is added ([\#282](https://github.com/Merck/simtrial/issues/282),
  thanks to [@jdblischak](https://github.com/jdblischak)).

## simtrial 0.4.1

CRAN release: 2024-05-03

### Improvements

- Pass `noSuggests` checks by running code examples, tests, and
  vignettes conditionally if the `Suggests` dependencies are not
  installed ([\#243](https://github.com/Merck/simtrial/issues/243)).

## simtrial 0.4.0

### New features

- [`rmst()`](https://merck.github.io/simtrial/reference/rmst.md)
  introduces the RMST test
  ([\#188](https://github.com/Merck/simtrial/issues/188), thanks,
  [@LittleBeannie](https://github.com/LittleBeannie)).
- [`milestone()`](https://merck.github.io/simtrial/reference/milestone.md)
  introduces the milestone test
  ([\#199](https://github.com/Merck/simtrial/issues/199),
  [\#204](https://github.com/Merck/simtrial/issues/204),
  [\#211](https://github.com/Merck/simtrial/issues/211),
  [\#237](https://github.com/Merck/simtrial/issues/237), thanks,
  [@LittleBeannie](https://github.com/LittleBeannie)).
- [`sim_gs_n()`](https://merck.github.io/simtrial/reference/sim_gs_n.md)
  provides an experimental implementation for fixed sample size group
  sequential design simulation, with unit tests upcoming
  ([\#195](https://github.com/Merck/simtrial/issues/195),
  [\#201](https://github.com/Merck/simtrial/issues/201),
  [\#208](https://github.com/Merck/simtrial/issues/208),
  [\#212](https://github.com/Merck/simtrial/issues/212), thanks,
  [@LittleBeannie](https://github.com/LittleBeannie) and
  [@jdblischak](https://github.com/jdblischak)).
- [`create_cut()`](https://merck.github.io/simtrial/reference/create_cut.md)
  allows users to create custom interim and final analyses cuttings
  based on their specific requirements
  ([\#201](https://github.com/Merck/simtrial/issues/201),
  [\#221](https://github.com/Merck/simtrial/issues/221), thanks,
  [@jdblischak](https://github.com/jdblischak)).
- [`create_test()`](https://merck.github.io/simtrial/reference/create_test.md)
  enables users to create various testing approaches for interim and
  final analyses ([\#215](https://github.com/Merck/simtrial/issues/215),
  [\#221](https://github.com/Merck/simtrial/issues/221), thanks,
  [@jdblischak](https://github.com/jdblischak)).
- [`multitest()`](https://merck.github.io/simtrial/reference/multitest.md)
  gives users the option to perform multiple tests on a simulated
  dataset ([\#215](https://github.com/Merck/simtrial/issues/215),
  thanks, [@jdblischak](https://github.com/jdblischak)). Note: This
  function is still experimental and may be improved in future releases,
  as it was created prior to the standardization of test functions in
  [\#227](https://github.com/Merck/simtrial/issues/227).
- Test outputs (logrank, weighted logrank, RMST, milestone, MaxCombo)
  are now unified as a list including method, parameter, estimate, se,
  z-value, and p-value
  ([\#227](https://github.com/Merck/simtrial/issues/227), thanks,
  [@LittleBeannie](https://github.com/LittleBeannie)).

### Bug fixes

- Fixed incorrect weights generated by
  [`early_zero()`](https://merck.github.io/simtrial/reference/early_zero.md)
  under stratified designs
  ([\#233](https://github.com/Merck/simtrial/issues/233), thanks,
  [@LittleBeannie](https://github.com/LittleBeannie)).

### Documentation

- Enhanced documentation for
  [`get_analysis_date()`](https://merck.github.io/simtrial/reference/get_analysis_date.md)
  ([\#186](https://github.com/Merck/simtrial/issues/186), thanks,
  [@LittleBeannie](https://github.com/LittleBeannie)).

### Dependency

- Removed dependency on the bshazard package as it was archived by CRAN
  ([\#234](https://github.com/Merck/simtrial/issues/234), thanks,
  [@nanxstats](https://github.com/nanxstats)).

## simtrial 0.3.2

CRAN release: 2023-12-11

This release makes minor improvements on auxiliary code with
side-effects.

### Improvements

- Remove the code that sets
  [`options()`](https://rdrr.io/r/base/options.html) within
  [`vignette("modest-wlrt")`](https://merck.github.io/simtrial/articles/modest-wlrt.md).
- Updated the code used for generating image assets. These scripts now
  write to [`tempdir()`](https://rdrr.io/r/base/tempfile.html) instead
  of the package directory.

## simtrial 0.3.1

This release introduces significant changes to the API, improves
simulation performance substantially, and adds new features and
documentation.

### Significant user-visible changes

- Complete overhaul of the API. Function and argument names now use
  snake case for consistency and readability. See the [function
  reference](https://merck.github.io/simtrial/reference/) for the
  updated naming scheme. Detailed change history is available in the
  merged pull requests (thanks,
  [@LittleBeannie](https://github.com/LittleBeannie),
  [@lili-ling-msd](https://github.com/lili-ling-msd), and
  [@XintongLi2023](https://github.com/XintongLi2023)).
- Dataset names updated to snake case (thanks,
  [@nanxstats](https://github.com/nanxstats),
  [\#164](https://github.com/Merck/simtrial/issues/164)).
- The base pipe operator is now used throughout the package. The
  magrittr pipe is no longer re-exported (thanks,
  [@nanxstats](https://github.com/nanxstats),
  [\#146](https://github.com/Merck/simtrial/issues/146)).

### Improvements

- Rewritten table backend for simtrial functions using data.table,
  achieving a 3x to 5x speedup compared to the previous implementation
  (thanks, [@jdblischak](https://github.com/jdblischak),
  [\#111](https://github.com/Merck/simtrial/issues/111)).
- [`sim_fixed_n()`](https://merck.github.io/simtrial/reference/sim_fixed_n.md)
  now utilizes the `%dofuture%` operator for parallelization, enhancing
  flexibility and reproducibility (thanks,
  [@cmansch](https://github.com/cmansch),
  [\#110](https://github.com/Merck/simtrial/issues/110)).
- [`rpwexp()`](https://merck.github.io/simtrial/reference/rpwexp.md)
  adopts the inverse CDF method for random number generation, with the
  naive methods now as internal functions (thanks,
  [@jianxiaoyang](https://github.com/jianxiaoyang),
  [\#15](https://github.com/Merck/simtrial/issues/15) and
  [\#174](https://github.com/Merck/simtrial/issues/174)).
- [`sim_fixed_n()`](https://merck.github.io/simtrial/reference/sim_fixed_n.md)
  is optimized to skip Breslow’s method in the absence of ties (thanks,
  [@jdblischak](https://github.com/jdblischak),
  [\#130](https://github.com/Merck/simtrial/issues/130)).
- The internal function for computing Z statistics in Fleming-Harrington
  weighted logrank tests is now named `wlr_z_stat()` (thanks,
  [@elong0527](https://github.com/elong0527),
  [\#105](https://github.com/Merck/simtrial/issues/105)).

### New features

- `early_zero_weight()` is added as a weighting function for early data
  removal (thanks, [@LittleBeannie](https://github.com/LittleBeannie),
  [\#123](https://github.com/Merck/simtrial/issues/123)).
- [`get_analysis_date()`](https://merck.github.io/simtrial/reference/get_analysis_date.md)
  is added to calculate interim/final analysis dates under various
  conditions (thanks,
  [@LittleBeannie](https://github.com/LittleBeannie),
  [\#122](https://github.com/Merck/simtrial/issues/122)).

### Documentation

- New
  [`vignette("workflow")`](https://merck.github.io/simtrial/articles/workflow.md)
  providing an overview of data manipulations involved in TTE
  simulations (thanks, [@keaven](https://github.com/keaven),
  [\#99](https://github.com/Merck/simtrial/issues/99)).
- New
  [`vignette("parallel")`](https://merck.github.io/simtrial/articles/parallel.md)
  demonstrating the parallelization workflow and coding best practices
  (thanks, [@cmansch](https://github.com/cmansch),
  [\#113](https://github.com/Merck/simtrial/issues/113) and
  [\#134](https://github.com/Merck/simtrial/issues/134)).

### Miscellaneous

- Added a hex sticker logo with a generative art design for the package
  (thanks, [@keaven](https://github.com/keaven),
  [\#158](https://github.com/Merck/simtrial/issues/158)).

## simtrial 0.2.2

GitHub release in February 2023.

This is the version that enables parallel computation in `simfix()`.

## simtrial 0.2.1

GitHub release in May 2022.

This version supports the *Biometrical Journal* paper “A unified
framework for weighted parametric group sequential design (WPGSD)” by
Keaven M. Anderson, Zifang Guo, Jing Zhao, and Linda Z. Sun.

## simtrial 0.2.0

Internal development release in August 2020.

- Updated vignettes and website.
- Prepared for Regulatory/Industry training session in September.

## simtrial 0.1.7.9004

Internal development release in February 2020.

- Added `wMB()` to compute Magirr-Burman weights.
- Added vignette to demonstrate working with different weighting
  schemes.
- Replaced `Depends` with `Imports` in `DESCRIPTION`.

## simtrial 0.1.7.9003

Internal development release in November 2019.

- Incorporated new functions to simplify use (`simfix()`,
  `simfix2simPWSurv()`, `pMaxCombo()`).
- Removed `hgraph()` with intent to put it into a release of gsDesign.
- Limited to 2 essential vignettes.
- Added continuous integration/continuous deployment (YAML) and pkgdown
  for website generation.
- Limited dependencies to those that are essential; this removed some
  convenience functions not related to core package functionality.
